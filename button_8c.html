<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Gear Position Indicator: button.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Gear Position Indicator
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">button.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Button functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="button_8h_source.html">button.h</a>&quot;</code><br/>
<code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="gpi_8h_source.html">gpi.h</a>&quot;</code><br/>
<code>#include &lt;util/delay.h&gt;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3513b5d9ff80446d7a74aa26d3848fda"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="button_8c.html#a3513b5d9ff80446d7a74aa26d3848fda">ResetButtonState</a> ()</td></tr>
<tr class="memdesc:a3513b5d9ff80446d7a74aa26d3848fda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset internal state of CheckButton() function.  <a href="#a3513b5d9ff80446d7a74aa26d3848fda"></a><br/></td></tr>
<tr class="separator:a3513b5d9ff80446d7a74aa26d3848fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af26541fdc73378654fbb00869ab90be5"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="button_8c.html#af26541fdc73378654fbb00869ab90be5">ButtonDown</a> ()</td></tr>
<tr class="memdesc:af26541fdc73378654fbb00869ab90be5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if button is down.  <a href="#af26541fdc73378654fbb00869ab90be5"></a><br/></td></tr>
<tr class="separator:af26541fdc73378654fbb00869ab90be5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab674ed7ebde5dcc258faf23aee238b9"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="button_8c.html#aab674ed7ebde5dcc258faf23aee238b9">ButtonCheck</a> ()</td></tr>
<tr class="memdesc:aab674ed7ebde5dcc258faf23aee238b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check button state.  <a href="#aab674ed7ebde5dcc258faf23aee238b9"></a><br/></td></tr>
<tr class="separator:aab674ed7ebde5dcc258faf23aee238b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Button functions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aab674ed7ebde5dcc258faf23aee238b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t ButtonCheck </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check button state. </p>
<p>The function must be called min. every 20ms to detect button state changes. For longer times it can not detect all the states. For shorter periods it can detect false states.</p>
<p>It keeps its internal state and thanks to that it can detect short or long button push. It also can detect when button was pushed (falling edge). The function does not block execution of the main program (no any delays inside).</p>
<p>It is recommended to use <a class="el" href="button_8c.html#a3513b5d9ff80446d7a74aa26d3848fda" title="Reset internal state of CheckButton() function.">ResetButtonState()</a> function to initialize internal state of the function.</p>
<p>When used press the button for long time the sequence of returning values is:</p>
<ol type="1">
<li>BUTTON_NONE</li>
<li>BUTTON_DOWN</li>
<li>BUTTON_LONG</li>
</ol>
<p>When button is pushed for short time, the sequence is:</p>
<ol type="1">
<li>BUTTON_NONE</li>
<li>BUTTON_DOWN</li>
<li>BUTTON_SHORT</li>
</ol>
<p>To detect <em>BUTTON_DOWN</em> state function must be called at least twice.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">BUTTON_NONE</td><td>button untouched </td></tr>
    <tr><td class="paramname">BUTTON_SHORT</td><td>button pressed shortly </td></tr>
    <tr><td class="paramname">BUTTON_LONG</td><td>button pressed for long time </td></tr>
    <tr><td class="paramname">BUTTON_DOWN</td><td>bottom was pressed, the state was changed from untouched to pressed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">uint8_t b;</div>
<div class="line"><span class="keywordflow">while</span>(1)</div>
<div class="line">{</div>
<div class="line">  b = <a class="code" href="button_8c.html#aab674ed7ebde5dcc258faf23aee238b9" title="Check button state.">ButtonCheck</a>();</div>
<div class="line">  <span class="keywordflow">if</span>( b == <a class="code" href="button_8h.html#aaa2d2ad4374cc67ad2f9e3cee397d0e9" title="Short click.">BUTTON_SHORT</a> )</div>
<div class="line">        puts(<span class="stringliteral">&quot;Short&quot;</span>);</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span>( b == <a class="code" href="button_8h.html#aa71533228ac74bed81757657b63b6aec" title="Long click.">BUTTON_LONG</a> )</div>
<div class="line">        puts(<span class="stringliteral">&quot;Long&quot;</span>);</div>
<div class="line"></div>
<div class="line">  _delay_ms(20);</div>
<div class="line">}</div>
</div><!-- fragment --></dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="button_8c.html#a3513b5d9ff80446d7a74aa26d3848fda" title="Reset internal state of CheckButton() function.">ResetButtonState()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="af26541fdc73378654fbb00869ab90be5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t ButtonDown </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if button is down. </p>
<p>The button is pressed when it's state has changed from 0 to 1. Function blocks execution of the program for <a class="el" href="button_8h.html#a83cdd160ac40ba3e1f36cf4c4d7e9a15">BUTTON_DEBOUNCE_TIME</a>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">BUTTON_NONE</td><td>nothing </td></tr>
    <tr><td class="paramname">BUTTON_DOWN</td><td>button down</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="button_8c.html#aab674ed7ebde5dcc258faf23aee238b9" title="Check button state.">ButtonCheck()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a3513b5d9ff80446d7a74aa26d3848fda"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ResetButtonState </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset internal state of CheckButton() function. </p>
<p>It is needed to reset state before check state loop. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Dec 23 2012 17:05:24 for Gear Position Indicator by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
